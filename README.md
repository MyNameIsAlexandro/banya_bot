# Banya Bot

Telegram бот и Mini App для поиска и бронирования бань и пар-мастеров.

## Возможности

### Для клиентов
- Поиск бань по городу и фильтрам (русская баня, финская сауна, хаммам, бассейн и др.)
- Просмотр детальной информации о бане (удобства, услуги, цены, рейтинг)
- Онлайн-бронирование с выбором даты, времени и продолжительности
- Поиск и бронирование пар-мастеров
- Управление бронированиями
- Профиль с рейтингом и статистикой
- Premium подписка со скидками и приоритетным бронированием

### Для владельцев бань (B2B)
- Управление своими банями
- Получение уведомлений о бронированиях
- Статистика и аналитика

### Для пар-мастеров
- Профиль мастера с описанием специализаций
- Привязка к банями
- Получение заказов

## Технологический стек

- **Backend**: Python 3.11+
- **Bot Framework**: aiogram 3.x
- **API**: FastAPI
- **Database**: SQLAlchemy + PostgreSQL/SQLite
- **Frontend (Mini App)**: HTML/CSS/JavaScript + Telegram WebApp SDK

## Структура проекта

```
banya_bot/
├── src/
│   ├── bot/              # Telegram бот
│   │   ├── handlers/     # Обработчики команд
│   │   └── keyboards/    # Клавиатуры
│   ├── api/              # FastAPI приложение
│   │   └── routes/       # API endpoints
│   └── database/         # Модели и подключение к БД
├── webapp/               # Telegram Mini App
│   ├── index.html
│   ├── styles.css
│   └── app.js
├── main.py               # Точка входа
├── pyproject.toml        # Зависимости
└── .env.example          # Пример конфигурации
```

## Установка

### 1. Клонирование репозитория

```bash
git clone https://github.com/your-username/banya_bot.git
cd banya_bot
```

### 2. Создание виртуального окружения

```bash
python -m venv .venv
source .venv/bin/activate  # Linux/macOS
# или
.venv\Scripts\activate     # Windows
```

### 3. Установка зависимостей

```bash
pip install -e .
```

### 4. Настройка окружения

```bash
cp .env.example .env
```

Отредактируйте `.env` и укажите:
- `BOT_TOKEN` - токен бота от @BotFather
- `DATABASE_URL` - URL базы данных
- `MINI_APP_URL` - URL Mini App (после деплоя)

### 5. Инициализация базы данных с демо-данными

```bash
python main.py seed
```

## Запуск

### Только бот
```bash
python main.py bot
```

### Только API сервер
```bash
python main.py api
```

### Бот и API вместе
```bash
python main.py all
```

## Команды бота

- `/start` - Начать работу с ботом
- `/help` - Справка по командам
- `/search` - Найти баню
- `/masters` - Найти пар-мастера
- `/bookings` - Мои бронирования
- `/profile` - Мой профиль

## API Endpoints

### Бани
- `GET /api/banyas/cities` - Список городов
- `GET /api/banyas` - Список бань с фильтрами
- `GET /api/banyas/{id}` - Детали бани
- `GET /api/banyas/{id}/available-slots` - Доступные слоты для бронирования

### Бронирования
- `POST /api/bookings` - Создать бронирование
- `GET /api/bookings` - Список бронирований пользователя
- `PATCH /api/bookings/{id}/confirm` - Подтвердить бронирование
- `PATCH /api/bookings/{id}/cancel` - Отменить бронирование

### Пользователи
- `POST /api/users` - Создать/получить пользователя
- `GET /api/users/me` - Текущий пользователь

### Мастера
- `GET /api/masters` - Список пар-мастеров
- `GET /api/masters/{id}` - Детали мастера

## Монетизация

### B2C (Freemium)
- **Бесплатно**: Поиск, просмотр, бронирование
- **Premium** (299 ₽/мес): Скидки 10%, приоритетное бронирование, эксклюзивные акции

### B2B
- Комиссия с бронирований (5-15%)
- Подписка для бань и мастеров

## Развитие

### MVP (текущая версия)
- [x] Поиск бань по городу
- [x] Фильтры по типу бани
- [x] Онлайн-бронирование
- [x] Telegram Mini App
- [x] API для интеграций

### Следующие шаги
- [ ] Карта с геолокацией
- [ ] Система отзывов
- [ ] Push-уведомления
- [ ] Оплата через бота
- [ ] Админ-панель для владельцев
- [ ] Интеграция с CRM банями

## Лицензия

MIT License
